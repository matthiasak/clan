{"version":3,"sources":["batch.js","fp.js","hamt.js","index.js","vdom.js","mixin.js","model.js","observable.js","worker.js"],"names":["batch","inflight","url","options","method","key","JSON","stringify","toLowerCase","f","Object","assign","compress","Promise","res","rej","then","d","catch","e","data","console","error","log","rAF","document","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","process","nextTick","setTimeout","cb","c","g","x","cof","fns","reduce","acc","fn","cob","reverse","pf","args","apply","curry","bind","mapping","mapper","reducer","result","value","filtering","predicate","concatter","thing","concat","hamming","popcount","root","children","sum","i","hash","v","length","charCodeAt","comp","a","b","HMAP_SIZE","MAX_DEPTH","vec","h","range","shallowClone","y","create","cloneNode","node","val","numChildren","set","newroot","r","n","bits","cp","cn","rh","j","__r","__n","vecr","vecn","_r","get","first","unset","_n","item","map","filter","toList","push","toOrderedList","toJSON","toJson","pop","shift","k","unshift","hamt","worker","fp","_v","len","module","exports","vdom","mixin","model","obs","class_id_regex","tagName_regex","parseSelector","test","tagreg","exec","s","tag","slice","reg","substr","className","trim","id","debounce","func","wait","immediate","timeout","callNow","clearTimeout","m","selector","attrs","Array","Function","shouldUpdate","unload","config","__hash","stripEvents","name","applyEvents","events","el","strip_existing","removeEvents","flatten","arr","EVENTS","split","mnt","render","applyUpdates","stylify","style","setAttrs","attr","innerHTML","setAttribute","_id","_className","createTag","parent","parentElement","t","createTextNode","insertBefore","removeEl","appendChild","shouldExchange","tagName","_shouldUpdate","createElement","removeChild","insertAt","next_sib","resolve","_el","vdom_children","el_children","childNodes","resolver","states","promises","done","_await","_promises","finish","ms","total","all","props","keys","forEach","getState","isDone","gs","view","state","instance","reservedAttrs","toHTML","_vdom","html","_class","_attrs","inner","indexOf","str","join","container","queries","wrapper_view","qs","querySelector","update","mount","classes","_mixin","proto","prototype","p","getOwnPropertyNames","oldFn","call","arguments","is","type","isValid","String","Number","Boolean","check","types","required","_type","MODEL","init","logic","pipe","whenValid","ArrayOf","M","subscribers","o","take","values","delete","takeWhile","maybe","success","stop","ts","Date","now","from","union","fs","supports","q","window","supportsWorkers","supportsBlobs","supportsURLs","supportsBuilders","code","B","U","W","blob","append","getBlob","encodeURIComponent","createObjectURL","Worker","farm","workers","fill","current","iter","onerror","w","onmessage","postMessage"],"mappings":"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","file":"","sourcesContent":["\n// batched requests\n// The `fetch()` module batches in-flight requests, so if at any point in time, anywhere in my front-end or\n// back-end application I have a calls occur to `fetch('http://api.github.com/users/matthiasak')` while another\n// to that URL is \"in-flight\", the Promise returned by both of those calls will be resolved by a single network request.\n\n// f :: (url -> options) -> Promise\nconst batch = f => {\n    let inflight = {}\n\n    return (url, options={}) => {\n        let {method} = options,\n            key = `${url}:${JSON.stringify(options)}`\n\n        if((method || '').toLowerCase() === 'post')\n            return f(url, Object.assign({}, options, {compress: false}))\n\n        return inflight[key] ||\n            (inflight[key] =\n                new Promise((res,rej) => {\n                    f(url, Object.assign({}, options, {compress: false}))\n                    .then(d => res(d))\n                    .catch(e => rej(e))\n                })\n                .then(data => {\n                    inflight = Object.assign({}, inflight, {[key]: undefined})\n                    return data\n                })\n                .catch(e =>\n                    console.error(e, url)))\n    }\n}\n\nexport default batch","export const log = (...a) => console.log(...a)\n\n// rAF\nexport const rAF =\n      typeof document !== 'undefined' &&\n      (requestAnimationFrame ||\n      webkitRequestAnimationFrame ||\n      mozRequestAnimationFrame) ||\n      process && process.nextTick ||\n      (cb => setTimeout(cb, 16.6))\n\n// composition\n// c :: (T -> U) -> (U -> V) -> (T -> V)\nexport const c = (f,g) => x => f(g(x))\n\n// cof :: [(an -> bn)] -> a0 -> bn\n// compose forward\nexport const cof = (...fns) => fns.reduce((acc,fn) => c(acc, fn))\n\n// cob :: [(an -> bn)] -> b0 -> an\n// compose backwards\nexport const cob = (...fns) => cof(...fns.reverse())\n\n// functional utilities\n// pointfree\nexport const pf = fn => (...args) => x => fn.apply(x, args)\n\n// curry\n// curry :: (T -> U) -> [args] -> ( -> U)\nexport const curry = (fn, ...args) =>\n\tfn.bind(undefined, ...args)\n\n\n// Transducers\nexport const mapping = (mapper) => // mapper: x -> y\n    (reducer) => // reducer: (state, value) -> new state\n        (result, value) =>\n            reducer(result, mapper(value))\n\nexport const filtering = (predicate) => // predicate: x -> true/false\n    (reducer) => // reducer: (state, value) -> new state\n        (result, value) =>\n            predicate(value) ? reducer(result, value) : result\n\nexport const concatter = (thing, value) =>\n    thing.concat([value])\n","// compute the hamming weight\nexport const hamming = x => {\n    x -= ((x >> 1) & 0x55555555)\n    x = (x & 0x33333333) + ((x >> 2) & 0x33333333)\n    x = (x + (x >> 4)) & 0x0f0f0f0f\n    x += (x >> 8)\n    x += (x >> 16)\n    return (x & 0x7f)\n}\n\nexport const popcount = root => {\n    if(root.key)\n        return 1\n\n    let c = root.children\n    if(c) {\n        var sum = 0\n        for(var i in c) sum += popcount(c[i])\n        return sum\n    }\n}\n\n// hash fn\nexport const hash = (v='') => {\n    v = JSON.stringify(v)\n    var hash = 5381\n    for (let i = 0; i < v.length; i++)\n        hash = ((hash << 5) + hash) + v.charCodeAt(i)\n    return hash\n}\n\n// compare two hashes\nexport const comp = (a,b) => hash(a) === hash(b)\n\n// get a bit vector\nexport const HMAP_SIZE = 8\nexport const MAX_DEPTH = 32 / HMAP_SIZE - 1\nexport const vec = (h=0, i=0, range=HMAP_SIZE) => (h >>> (range*i)) & ((1 << range) - 1)\n\nexport const shallowClone = x => {\n    let y = Object.create(null)\n    for(let i in x)\n        y[i] = x[i]\n    return y\n}\n\nexport const cloneNode = x => {\n    let y = node()\n    if(!x) return y\n\n    if(x.children) {\n        y.children = shallowClone(x.children)\n    } else if(x.key !== undefined) {\n        y.key = x.key\n        y.val = x.val\n        y.hash = x.hash\n    }\n\n    return y\n}\n\nexport const numChildren = x => {\n    let c = 0\n    for(var i in x) ++c\n    return c\n}\n\nexport const set = (root, key, val) => {\n    if((root.key === undefined) && !root.children) return node(key, val)\n\n    const newroot = cloneNode(root), h = hash(key)\n\n    // walk the tree\n    for(var i = 3, r = root, n = newroot; i >= 0; --i){\n        let bits = vec(h, i)\n\n        if(r.key !== undefined){\n            // if we have a collision\n            if(r.key === key || i === 0) {\n                // if keys match or is leaf, just overwrite n's val\n                n.val = val\n            } else if(i !== 0) {\n                // else if r is not at max depth and keys don't match\n                // add levels to both trees, new tree must be able\n                // to access old data\n\n                // 0. create makeshift value node for r\n                // and new value node for n\n                let cp = node(r.key, r.val, r.hash)\n                let cn = node(key, val, h)\n                let rh = r.hash\n\n                // 1. delete value props from nodes\n                delete r.key\n                delete r.val\n                delete r.hash\n                delete n.key\n                delete n.val\n                delete n.hash\n\n                // 2. create layers until bit-vectors don't collide\n                for(let j = i, __r = r, __n = n; j >= 0; j--){\n                    let vecr = vec(rh, j),\n                        vecn = vec(h, j)\n\n                    // create new layer for c and r\n                    let c = __r.children = Object.create(null)\n                    let d = __n.children = shallowClone(c)\n\n                    if(vecr !== vecn) {\n                        c[vecr] = cp\n                        d[vecr] = cp\n                        d[vecn] = cn\n                        break\n                    } else {\n                        __r = c[vecr] = node()\n                        __n = d[vecn] = cloneNode(__r)\n                    }\n                }\n            }\n            break\n        } else if(r.children) {\n            let _r = r.children[bits]\n            if(!_r) {\n                n = n.children[bits] = node(key, val)\n                break\n            } else {\n                r = _r\n                n = n.children[bits] = cloneNode(r)\n            }\n        }\n    }\n\n    return newroot\n}\n\nexport const get = (root, key) => {\n    if(root.key === key) return root.val\n    const h = hash(key)\n    for(let i = 3, r = root; i >= 0; --i){\n        if(!r.children) return undefined\n        r = r.children[vec(h, i)]\n        if(!r) return undefined\n        if(r.key !== undefined) return r.val\n    }\n\n    return undefined\n}\n\nexport const first = root => {\n    let c = root.children\n    for(let i in c) return c[i]\n}\n\nexport const unset = (root, key) => {\n    const n = cloneNode(root),\n          h = hash(key)\n\n    for(var i = 3, _n = n, p = n; i >= -1; --i) {\n        if(_n.key) {\n            delete _n.key\n            delete _n.val\n            delete _n.hash\n            return n\n\n//             let c = numChildren(p)\n\n//             if(c === 1) {\n//                 // if only child, delete child and parent?\n//                 delete p.children\n//             } else if(c===2){\n//                 // if 2 children, promote sibling as parent value nod\n//                 delete p.children[bits]\n//                 let sibling = first(p)\n//                 delete p.children\n//                 if(sibling.children){\n//                     p.children = sibling.children\n//                 } else if(p.key) {\n//                     p.val = sibling.val\n//                     p.hash = sibling.hash\n//                     p.key = sibling.key\n//                 }\n//             } else {\n//                 // if more than 2 children, just delete the one\n//                 delete p.children[bits]\n//             }\n//             return n\n        }\n\n        const bits = vec(h, i)\n        _n = _n && _n.children && _n.children[bits]\n        if(!_n) return n\n        p = _n\n    }\n    return n\n}\n\nexport const node = (key,val,h= key !== undefined && hash(key)) => {\n    /*\n    potential props of a tree node\n    - key - hashkey\n    - val - value\n    - children - { ... } -> points to other nodes (List<Node> children)\n    */\n\n    let item = Object.create(null)\n    if(key !== undefined){\n        item.key = key\n        item.hash = h\n        item.val = val\n    }\n    return item\n}\n\nexport const map = (root, fn) => {\n    if(root.key !== undefined)\n        return node(root.key, fn(root.val, root.key), root.hash)\n\n    let d = cloneNode(root),\n        c = d.children\n\n    if(c) {\n        for(var i in c){\n            c[i] = map(c[i], fn)\n        }\n    }\n\n    return d\n}\n\nexport const filter = (root, fn) => {\n    if(root.key !== undefined)\n        return fn(root.val, root.key) ? root : undefined\n\n    let d = cloneNode(root),\n        c = d.children\n\n    if(c) {\n        for(var i in c){\n            if(!filter(c[i], fn))\n                delete c[i]\n        }\n    }\n\n    return d\n}\n\nexport const reduce = (root, fn, acc) => {\n    if(root.key !== undefined)\n        return fn(acc, root.val, root.key)\n\n    let c = root.children\n    if(c) {\n        for(var i in c)\n            acc = reduce(c[i], fn, acc)\n\n        return acc\n    }\n}\n\nexport const toList = (root, r=[]) => {\n    if(root.key !== undefined) r.push(root.val)\n\n    let c = root.children\n    if(c) {\n        for(var i in c) {\n            toList(c[i], r)\n        }\n    }\n\n    return r\n}\n\nexport const toOrderedList = (root, r=[]) => {\n    let i = 0,\n        n\n\n    do {\n        n = get(root, i++)\n        n !== undefined && r.push(n)\n    } while(n)\n\n    return r\n}\n\nexport const toJSON = (root, r={}) => {\n    if(root.key !== undefined)\n        r[root.key] = root.val\n\n    let c = root.children\n    if(c) {\n        for(var i in c) {\n            toJson(c[i], r)\n        }\n    }\n\n    return r\n}\n\nexport const push = (root, val) => set(root, popcount(root), val)\n\nexport const pop = root => unset(root, popcount(root)-1)\n\nexport const shift = root => reduce(\n    unset(root, 0),\n    (acc,v,k) => set(acc, k-1, v),\n    node())\n\nexport const unshift = (root, val) =>\n    set(\n        reduce(\n            root,\n            (acc,v,k) => set(acc, k+1, v),\n            node()),\n        0,\n        val)\n\nexport const hamt = node\n\n// console.clear()\n// const l = (...args) => console.log(...args)\n// const j = (...a) => console.log(JSON.stringify(a))\n\n// let x = hamt()\n// let s = 20\n\n// Array(s).fill(1).map((v,i) => {\n//     x = set(x, i, i)\n// })\n\n// l(toList(x))\n// l(toJson(x))\n\n// x = map(x, x => log(x*x) || x*x)\n// l(get(x, 19))\n\n// l(x)\n// l(reduce(x, (acc, x) => acc+x, 0))\n\n// x = unset(x, 1)\n// Array(s).fill(1).map((_,i) => {\n//     if(!get(x, i)) l(i)\n//     // l(get(x, i))\n// })","import batch from './batch'\nimport vdom from './vdom'\nimport mixin from './mixin'\nimport model from './model'\nimport obs from './observable'\nimport * as hamt from './hamt'\nimport * as worker from './worker'\nimport * as fp from './fp'\n\nexport const hash = (v,_v=JSON.stringify(v)) => {\n    let hash = 0\n    for (let i = 0, len = _v.length; i < len; ++i) {\n        const c = _v.charCodeAt(i)\n        hash = (((hash << 5) - hash) + c) | 0\n    }\n    return hash\n}\n\nmodule.exports = {\n\tbatch\n\t, vdom\n\t, mixin\n\t, model\n\t, obs\n\t, hamt\n\t, worker\n\t, fp\n}\n","const rAF =\n      typeof document !== 'undefined' &&\n      (requestAnimationFrame ||\n      webkitRequestAnimationFrame ||\n      mozRequestAnimationFrame) ||\n      (cb => setTimeout(cb, 16.6))\n\n// Virtual DOMs\nconst vdom = () => {\n    const class_id_regex = () => {\n            return /[#\\.][^#\\.]+/ig\n        },\n        tagName_regex = () => {\n            return /^([^\\.#]+)\\b/i\n        }\n\n    const parseSelector = s => {\n        let test = null,\n            tagreg = tagName_regex().exec(s),\n            tag = tagreg && tagreg.slice(1)[0],\n            reg = class_id_regex(),\n            vdom = Object.create(null)\n\n        if(tag) s = s.substr(tag.length)\n        vdom.className = ''\n        vdom.tag = tag || 'div'\n\n        while((test = reg.exec(s)) !== null){\n            test = test[0]\n            if(test[0] === '.')\n                vdom.className = (vdom.className+' '+test.substr(1)).trim()\n            else if(test[0] === '#')\n                vdom.id = test.substr(1)\n        }\n        return vdom\n    }\n\n    const debounce = (func, wait, immediate, timeout) =>\n        (...args) => {\n            let later = () => {\n                timeout = null\n                !immediate && func(...args)\n            }\n            var callNow = immediate && !timeout\n            clearTimeout(timeout)\n            timeout = setTimeout(later, wait || 0)\n            callNow && func(...args)\n        }\n\n    const hash = (v,_v=JSON.stringify(v)) => {\n        let hash = 0\n        for (let i = 0, len = _v.length; i < len; ++i) {\n            const c = _v.charCodeAt(i)\n            hash = (((hash << 5) - hash) + c) | 0\n        }\n        return hash\n    }\n\n    const m = (selector, attrs=Object.create(null), ...children) => {\n        if(attrs.tag || !(typeof attrs === 'object') || attrs instanceof Array || attrs instanceof Function){\n            if(attrs instanceof Array) children.unshift(...attrs)\n            else children.unshift(attrs)\n            attrs = Object.create(null)\n        }\n        let vdom = parseSelector(selector)\n        if(children.length)\n            vdom.children = children\n        vdom.attrs = attrs\n        vdom.shouldUpdate = attrs.shouldUpdate\n        vdom.unload = attrs.unload\n        vdom.config = attrs.config\n        vdom.__hash = hash(vdom)\n        delete attrs.unload\n        delete attrs.shouldUpdate\n        delete attrs.config\n        return vdom\n    }\n\n    // creatign html, strip events from DOM element... for now just deleting\n    const stripEvents = ({attrs}) => {\n        let a = Object.create(null)\n\n        if(attrs){\n            for(var name in attrs){\n                if(name[0]==='o'&&name[1]==='n') {\n                    a[name] = attrs[name]\n                    delete attrs[name]\n                }\n            }\n        }\n\n        return a\n    }\n\n    const applyEvents = (events, el, strip_existing=true) => {\n        strip_existing && removeEvents(el)\n        for(var name in events){\n            el[name] = events[name]\n        }\n    }\n\n    const flatten = (arr, a=[]) => {\n        for(var i=0,len=arr.length; i<len; i++){\n            let v = arr[i]\n            if(!(v instanceof Array)){\n                a.push(v)\n            } else {\n                flatten(v, a)\n            }\n        }\n        return a\n    }\n\n    const EVENTS = 'mouseover,mouseout,wheel,mousemove,blur,focus,click,abort,afterprint,animationend,animationiteration,animationstart,beforeprint,canplay,canplaythrough,change,contextmenu,dblclick,drag,dragend,dragenter,dragleave,dragover,dragstart,drop,durationchange,emptied,ended,error,load,input,invalid,keydown,keypress,keyup,loadeddata,loadedmetadata,mousedown,mouseenter,mouseleave,mouseup,pause,pointercancel,pointerdown,pointerenter,pointerleave,pointermove,pointerout,pointerover,pointerup,play,playing,ratechange,reset,resize,scroll,seeked,seeking,select,selectstart,selectionchange,show,submit,timeupdate,touchstart,touchend,touchcancel,touchmove,touchenter,touchleave,transitionend,volumechange,waiting'.split(',').map(x => 'on'+x)\n\n    const removeEvents = el => {\n        // strip away event handlers on el, if it exists\n        if(!el) return;\n        for(var i in EVENTS){\n            el[i] = null\n        }\n    }\n\n    let mnt\n\n    const mount = (fn, el) => {\n        mnt = [el, fn]\n        render(fn, el)\n    }\n\n    const render = debounce((fn, el) => rAF(_ => {\n        applyUpdates(fn, el.children[0], el)\n    }))\n\n    const update = () => {\n        if(!mnt) return\n        let [el, fn] = mnt\n        render(fn, el)\n    }\n\n    const stylify = style => {\n        let s = ''\n        for(var i in style){\n            s+=`${i}:${style[i]};`\n        }\n        return s\n    }\n\n    const setAttrs = ({attrs, id, className, __hash},el) => {\n    \tel.className = ''\n    \tel.style = ''\n\n        if(attrs){\n            for(var attr in attrs){\n                if(attr === 'style') {\n                    el.style = stylify(attrs[attr])\n                } else if(attr === 'innerHTML'){\n                    rAF(() => el.innerHTML = attrs[attr])\n                } else if(attr === 'value'){\n                    rAF(() => el.value = attrs[attr])\n                } else {\n                    el.setAttribute(attr, attrs[attr])\n                }\n            }\n        }\n        let _id = attrs.id || id\n        if(_id) el.id = _id\n        let _className = ((attrs.className || '') + ' ' + (className || '')).trim()\n        if(_className) el.className = _className\n        el.__hash = __hash\n    }\n\n    // recycle or create a new el\n    const createTag = (vdom=Object.create(null), el, parent=el&&el.parentElement) => {\n        let __vdom = vdom\n        // make text nodes from primitive types\n        if(typeof vdom !== 'object'){\n            let t = document.createTextNode(vdom)\n            if(el){\n                parent.insertBefore(t,el)\n                removeEl(el)\n            } else {\n                parent.appendChild(t)\n            }\n            return t\n        }\n\n        // else make an HTMLElement from \"tag\" types\n        let {tag, attrs, id, className, unload, shouldUpdate, config, __hash} = vdom,\n            shouldExchange = !el || !el.tagName || (tag && el.tagName.toLowerCase() !== tag.toLowerCase()),\n            _shouldUpdate = !(shouldUpdate instanceof Function) || shouldUpdate(el)\n\n        if(!attrs) return\n        if(el && (!_shouldUpdate || ((!vdom instanceof Function) && el.__hash === __hash))) {\n            return\n        }\n\n        if(shouldExchange){\n            let t = document.createElement(tag)\n            el ? (parent.insertBefore(t, el), removeEl(el)) : parent.appendChild(t)\n            el = t\n        }\n\n        setAttrs(vdom, el)\n        if(el.unload instanceof Function) {\n            rAF(el.unload)\n        }\n        if(unload instanceof Function) {\n            el.unload = unload\n        }\n        applyEvents(stripEvents(vdom), el)\n        config && rAF(_ => config(el))\n        return el\n    }\n\n    // find parent element, and remove the input element\n    const removeEl = el => {\n        if(!el) return\n        el.parentElement.removeChild(el)\n        removeEvents(el)\n        // removed for now, added unload logic to the immediate draw()s\n        if(el.unload instanceof Function)\n            el.unload()\n    }\n\n    const insertAt = (el, parent, i) => {\n        if(parent.children.length > i) {\n            let next_sib = parent.children[i]\n            parent.insertBefore(el, next_sib)\n        } else {\n            parent.appendChild(el)\n        }\n    }\n\n    const applyUpdates = (vdom, el, parent=el&&el.parentElement) => {\n        let v = vdom\n        // if vdom is a function, execute it until it isn't\n        while(vdom instanceof Function)\n            vdom = vdom()\n\n        if(!vdom) return\n\n        if(vdom.resolve instanceof Function){\n            let i = parent.children.length\n            return vdom.resolve().then(v => {\n                if(!el) {\n                    let x = createTag(v, null, parent)\n                    insertAt(x, parent, i)\n                    applyUpdates(v, x, parent)\n                } else {\n                    applyUpdates(v, el, parent)\n                }\n            })\n        }\n\n        // create/edit el under parent\n        let _el = vdom instanceof Array ? parent : createTag(vdom, el, parent)\n\n        if(!_el) return\n\n        if(vdom instanceof Array || vdom.children){\n            let vdom_children = flatten(vdom instanceof Array ? vdom : vdom.children),\n                el_children = vdom instanceof Array ? parent.childNodes : _el.childNodes\n\n            while(el_children.length > vdom_children.length){\n                removeEl(el_children[el_children.length-1])\n            }\n\n            for(let i=0; i<vdom_children.length; i++){\n                applyUpdates(vdom_children[i],el_children[i],_el)\n            }\n        } else {\n            while(_el.childNodes.length > 0){\n                removeEl(_el.childNodes[_el.childNodes.length-1])\n            }\n        }\n    }\n\n    const qs = (s='body', el=document) => el.querySelector(s)\n\n    const resolver  = (states = {}) => {\n        let promises = [],\n            done = false\n\n        const _await = (_promises = []) => {\n            promises = [...promises, ..._promises]\n            return finish()\n        }\n\n        const wait = (ms=0) => new Promise(res => setTimeout(res, ms))\n\n        const isDone = () => done\n\n        const finish = () => {\n            const total = promises.length\n            return wait().then(_ => Promise.all(promises)).then(values => {\n                if(promises.length > total){\n                    return finish()\n                }\n                done = true\n                return states\n            })\n        }\n\n        const resolve = (props) => {\n            const keys = Object.keys(props)\n            if (!keys.length)\n                return Promise.resolve(true)\n\n            let f = []\n            keys.forEach(name => {\n                let x = props[name]\n\n                while(x instanceof Function)\n                    x = x()\n\n                if(x && x.then instanceof Function)\n                    f.push(x.then(d => states[name] = d))\n            })\n\n            return _await(f)\n        }\n\n        const getState = () => states\n\n        return { finish, resolve, getState, promises, isDone }\n    }\n\n    const gs = (view, state) => {\n        let r = view(state)\n        while(r instanceof Function)\n            r = view(instance.getState())\n        return r\n    }\n\n    const container = (view, queries={}, instance=resolver()) => {\n        let wrapper_view = state =>\n            instance.isDone() ? view(state) : m('span')\n\n        return () => {\n            let r = gs(wrapper_view, instance.getState())\n            instance.resolve(queries)\n\n            if(r instanceof Array) {\n                let d = instance.finish().then(_ =>\n                    gs(wrapper_view, instance.getState()))\n\n                return r.map((x,i) => {\n                    x.resolve = _ => d.then(vdom => vdom[i])\n                    return x\n                })\n            }\n\n            r.resolve = _ => instance.finish().then(_ =>\n                gs(wrapper_view, instance.getState()))\n\n            return r\n        }\n    }\n\n    const reservedAttrs = ['className','id']\n\n    const toHTML = _vdom => {\n        while(_vdom instanceof Function) _vdom = _vdom()\n        if(_vdom instanceof Array) return new Promise(r => r(html(..._vdom)))\n        if(!_vdom) return new Promise(r => r(''))\n        if(typeof _vdom !== 'object') return new Promise(r => r(_vdom))\n        return (_vdom.resolve ? _vdom.resolve() : Promise.resolve()).then(vdom => {\n            if(!vdom) vdom = _vdom\n\n            if(vdom instanceof Array) return new Promise(r => r(html(...vdom)))\n\n            const {tag, id, className, attrs, children, instance} = vdom,\n                _id = (id || (attrs && attrs.id)) ? ` id=\"${(id || (attrs && attrs.id) || '')}\"` : '',\n                _class = (className || (attrs && attrs.className)) ? ` class=\"${((className||'') + ' ' + (attrs.className||'')).trim()}\"` : ''\n\n            const events = stripEvents(vdom)\n            let _attrs = '',\n                inner = ''\n            for(var i in (attrs || Object.create(null))){\n                if(i === 'style'){\n                    _attrs += ` style=\"${stylify(attrs[i])}\"`\n                } else if(i === 'innerHTML') {\n                    inner = attrs[i]\n                } else if(reservedAttrs.indexOf(i) === -1){\n                    _attrs += ` ${i}=\"${attrs[i]}\"`\n                }\n            }\n\n            if(!inner && children)\n                return html(...children).then(str =>\n                    `<${tag}${_id}${_class}${_attrs}>${str}</${tag}>`)\n\n            if('br,input,img'.split(',').filter(x => x===tag).length === 0)\n                return new Promise(r => r(`<${tag}${_id}${_class}${_attrs}>${inner}</${tag}>`))\n\n            return new Promise(r => r(`<${tag}${_id}${_class}${_attrs} />`))\n        })\n    }\n\n    const html = (...v) => Promise.all(v.map(toHTML)).then(x => x.filter(x => !!x).join(''))\n\n    return {container, html, qs, update, mount, m, debounce}\n}\n\nmodule.exports = vdom()\n\n/*\nusage:\n\nlet component = () =>\n    new Array(20).fill(true).map(x =>\n        m('div', {onMouseOver: e => log(e.target.innerHTML)}, range(1,100)))\n\nclient-side\n-----\nmount(component, qs())\n\nclient-side constant re-rendering\n-----\nconst run = () => {\n    setTimeout(run, 20)\n    update()\n}\nrun()\n*/\n\n/* CONTAINER / HTML USAGE (Server-side rendering)\n\nconst name = _ => new Promise(res => setTimeout(_ => res('matt'), 1500))\n\nlet x = container(data => [\n        m('div.test.row', {className:'hola', 'data-name':data.name, style:{border:'1px solid black'}}),\n        m('div', data.name),\n    ],\n    {name}\n)\n\nhtml(x).then(x => log(x)).catch(e => log(e+''))\n*/\n","\nconst mixin = (...classes) => {\n    class _mixin {}\n\n    let proto = _mixin.prototype\n\n    classes.map(({prototype:p}) => {\n        Object.getOwnPropertyNames(p).map(key => {\n            let oldFn = proto[key] || ($ => {})\n            proto[key] = function() {\n                oldFn.apply(null, [].slice.call(arguments))\n                return p[key].apply(null, [].slice.call(arguments))\n            }\n        })\n    })\n\n    return _mixin\n}\n\nmodule.exports = mixin","// Validate JS objects for their \"shape\"\nconst model = {\n    is(type, value) {\n        if(type && type.isValid instanceof Function){\n            return type.isValid(value)\n        } else if((type === String && ((value instanceof String) || typeof value === 'string'))\n            || (type === Number && ((value instanceof Number) || typeof value === 'number'))\n            || (type === Boolean && ((value instanceof Boolean) || typeof value === 'boolean'))\n            || (type === Function && ((value instanceof Function) || typeof value === 'function'))\n            || (type === Object && ((value instanceof Object) || typeof value === 'object'))\n            || (type === undefined)\n        ){\n            return true\n        }\n\n        return false\n    },\n    check(types, required, data) {\n        Object.keys(types).forEach(key => {\n            let t = types[key],\n                value = data[key]\n\n            if(required[key] || value !== undefined){\n                if(!(t instanceof Array)) t = [t]\n\n                let i = t.reduce((a,_type) => a || MODEL.is(_type, value), false)\n                if(!i) {\n                    throw `{${key}: ${JSON.stringify(value)}} is not one of ${t.map(x => `\\n - ${x}`)}`\n                }\n            }\n        })\n\n        return true\n    },\n    init(...args) {\n        let types, required, logic\n        args.map(x => {\n            if(x instanceof Function && !logic){ logic = x }\n            else if(typeof x === 'object') {\n                if(!types){ types = x }\n                else if(!required){ required = x }\n            }\n        })\n\n        const isValid = (data) => {\n            const pipe = logic ? [check, logic] : [check]\n            return pipe.reduce((a,v) => a && v(types||{},required||{},data), true)\n        }\n\n        const whenValid = (data) => new Promise((res,rej) => isValid(data) && res(data))\n\n        return {isValid, whenValid}\n    },\n    ArrayOf(M) {\n        return MODEL.init((t,r,data) => {\n            if(!(data instanceof Array)) throw `${data} not an Array`\n            data.map(x => {\n                if(!MODEL.is(M, x))\n                    throw `${x} is not a model instance`\n            })\n            return true\n        })\n    }\n}\n\nexport default model\n\n/**\nUse it\n\n// create a Name model with required first/last,\n// but optional middle\nlet Name = MODEL.init({\n    first: String,\n    middle: String,\n    last: String\n}, {first:true, last:true})\n\n// create a Tags model with extra checks\nlet Tags = MODEL.init((types,required,data) => {\n    if(!(data instanceof Array)) throw `${data} not an Array`\n    data.map(x => {\n        if(!is(String, x))\n            throw `[${data}] contains non-String`\n    })\n    return true\n})\n\n// create a Price model that just has a business logic fn\nlet Price = MODEL.init((t,r,d) => {\n    return (d instanceof Number || typeof d === 'number') && d !== 0\n})\n\n// create an Activity model with a required type and name,\n// all others optional\nlet Activity = MODEL.init({\n    type: [String, Function, Number],\n    latlng: Array,\n    title: String,\n    tags: Tags,\n    name: Name,\n    price: Price\n}, {name:true, price: true})\n\n// create a new Activity instance, throwing errors if there are\n// any invalid fields.\nlet a = {\n    tags: ['1','2'],\n    type: 1,\n    name: {first:'matt',last:'keas'},\n    price: 100.43,\n    url: 'http://www.google.com'\n}\nActivity.whenValid(a).then(log).catch(e => log(e+''))\n**/\n","// async-supporting-observables\nconst obs = (state) => {\n    let subscribers = []\n\n    const fn = (val) => {\n        if(val !== undefined){\n            state = val\n            for(let i = 0, len = subscribers.length; i<len; i++)\n            \tsubscribers[i](val)\n        }\n        return state\n    }\n\n    fn.map = f => {\n      const o = obs()\n      subscribers.push(val => o(f(val)))\n      return o\n    }\n\n    fn.filter = f => {\n      const o = obs()\n      subscribers.push(val => f(val) && o(val))\n      return o\n    }\n\n    fn.then = f => {\n      subscribers.push(val => f(val))\n      return fn\n    }\n\n    fn.take = (n) => {\n        const values = [],\n        \to = obs()\n\n        const cb = val => {\n            if(values.length < n)\n                values.push(val)\n\n            if(values.length === n) {\n                subscribers.delete(cb)\n                return o(values)\n            }\n        }\n\n        subscribers.push(cb)\n\n        return o\n    }\n\n    fn.takeWhile = f => {\n        const values = [],\n        \to = obs()\n\n        const cb = val => {\n            if(!f(val)) {\n                subscribers = subscribers.filter(x => x !== cb)\n                return o(values)\n            }\n\n\t\t\tvalues.push(val)\n        }\n\n        subscribers.push(cb)\n\n        return o\n    }\n\n    fn.reduce = (f,acc) => {\n        const o = obs()\n\n        subscribers.push(val => {\n            acc = f(acc,val)\n            o(acc)\n        })\n\n        return o\n    }\n\n    fn.maybe = f => {\n        const success = obs(),\n              error = obs(),\n              cb = val =>\n        \t\tf(val)\n\t\t\t\t    .then(d => success(d))\n                    .catch(e => error(e))\n\n        subscribers.push(cb)\n\n        return [ success, error ]\n    }\n\n    fn.stop = () => subscribers = []\n\n    fn.debounce = ms => {\n        const o = obs()\n        let ts = +new Date\n        subscribers.push(val => {\n            const now = +new Date\n            if(now - ts >= ms){\n                ts = +new Date\n                o(val)\n            }\n        })\n        return o\n    }\n\n    return fn\n}\n\nobs.from = f => {\n    const o = obs()\n    f(x => o(x))\n    return o\n}\n\nobs.union = (...fs) => {\n    const o = obs()\n    fs.map(f => f.then(o))\n    return o\n}\n\nexport default obs","const supports = (...q) => () =>\n    q.reduce((acc,s) =>\n        acc\n        || (window[s] !== undefined)\n        && /[native code]/.test(window[s]+'')\n        && window[s]\n    , false)\n\nconst supportsWorkers = supports('Worker')\n\nconst supportsBlobs = supports('Blob')\n\nconst supportsURLs = supports('URL', 'webkitURL')\n\nconst supportsBuilders = supports('BlobBuilder', 'WebKitBlobBuilder', 'MozBlobBuilder')\n\n/*\nworker:: [X] -> Worker where X : Function | String\n\nthe last X provided in the arguments will be setup as the handler for self.onmessage()\n*/\nexport const worker = (...code) => {\n    if(!supportsWorkers()) throw 'WebWorkers not supported'\n\n    code[code.length-1] = `self.onmessage=${code[code.length-1]}`\n\n    const B = supportsBlobs()\n        , U = supportsBuilders()\n        , W = supportsURLs()\n\n    let blob\n\n    if(supportsBlobs()) {\n        blob =\n            new B(code.map(c => c+''),\n            {type: 'application/javascript'})\n\n    } else if(U){\n        blob = new U\n        code.map(c => blob.append(c+''))\n        blob = blob.getBlob()\n    } else {\n        blob = `data:application/javascript,`\n            +`${encodeURIComponent(\n                code.reduce((acc,c) => acc+c, '')\n              )}`\n    }\n\n    let url = W.createObjectURL(blob)\n    return new Worker(url)\n}\n\nexport const farm = (n, ...code) => {\n    let workers = Array(n).fill(1).map(x => worker(...code))\n        , current = 0\n        , iter = () => {\n            let _n = current\n            ++current >= n && (current = 0)\n            return current\n        }\n        , pipe\n        , onerror\n\n    workers.map(w => {\n        w.onmessage = e => pipe instanceof Function && pipe(e.data)\n        w.onerror = e => onerror instanceof Function && onerror(e)\n    })\n\n    const exec = (...args) => {\n        let w = workers[iter()]\n        w && w.postMessage(args)\n    }\n\n    exec.pipe = fn => {\n        pipe = fn\n        return exec\n    }\n    exec.error = fn => {\n        onerror = fn\n        return exec\n    }\n    return exec\n}\n"]}