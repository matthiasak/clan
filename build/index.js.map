{"version":3,"sources":["index.js","batch.js","vdom.js","mixin.js","model.js","observable.js","hamt.js","worker.js","fp.js"],"names":["hamt","worker","fp","hash","v","_v","JSON","stringify","i","len","length","c","charCodeAt","module","exports","batch","vdom","mixin","model","obs","inflight","url","options","method","key","toLowerCase","f","Object","assign","compress","Promise","res","rej","then","d","catch","e","data","console","error","rAF","document","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","setTimeout","cb","class_id_regex","tagName_regex","parseSelector","test","tagreg","exec","s","tag","slice","reg","create","substr","className","trim","id","debounce","func","wait","immediate","timeout","args","callNow","clearTimeout","m","selector","children","attrs","Array","Function","unshift","shouldUpdate","unload","config","__hash","stripEvents","a","name","applyEvents","events","el","strip_existing","removeEvents","flatten","arr","push","EVENTS","split","map","x","mnt","render","fn","applyUpdates","stylify","style","setAttrs","attr","innerHTML","value","setAttribute","_id","_className","createTag","parent","parentElement","t","createTextNode","insertBefore","removeEl","appendChild","shouldExchange","tagName","_shouldUpdate","createElement","removeChild","insertAt","next_sib","resolve","_el","vdom_children","el_children","childNodes","resolver","states","promises","done","_await","_promises","finish","ms","total","all","props","keys","forEach","getState","isDone","gs","view","state","r","instance","reservedAttrs","toHTML","_vdom","html","_class","_attrs","inner","indexOf","str","filter","join","container","queries","wrapper_view","qs","querySelector","update","mount","classes","_mixin","proto","prototype","p","getOwnPropertyNames","oldFn","apply","call","arguments","is","type","isValid","String","Number","Boolean","check","types","required","reduce","_type","MODEL","init","logic","pipe","whenValid","ArrayOf","M","subscribers","val","o","take","n","values","delete","takeWhile","acc","maybe","success","stop","ts","Date","now","from","union","fs","hamming","popcount","root","sum","comp","b","HMAP_SIZE","MAX_DEPTH","vec","h","range","shallowClone","y","cloneNode","node","numChildren","set","newroot","bits","cp","cn","rh","j","__r","__n","vecr","vecn","_r","get","first","unset","_n","item","toList","toOrderedList","toJSON","toJson","pop","shift","k","supports","q","window","supportsWorkers","supportsBlobs","supportsURLs","supportsBuilders","code","B","U","W","blob","append","getBlob","encodeURIComponent","createObjectURL","Worker","farm","workers","fill","current","iter","onerror","w","onmessage","postMessage","log","process","nextTick","g","cof","fns","cob","reverse","pf","curry","bind","mapping","mapper","reducer","result","filtering","predicate","concatter","thing","concat"],"mappings":"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","file":"","sourcesContent":["import batch from './batch'\nimport vdom from './vdom'\nimport mixin from './mixin'\nimport model from './model'\nimport obs from './observable'\nimport * as hamt from './hamt'\nimport * as worker from './worker'\nimport * as fp from './fp'\n\nexport const hash = (v,_v=JSON.stringify(v)) => {\n    let hash = 0\n    for (let i = 0, len = _v.length; i < len; ++i) {\n        const c = _v.charCodeAt(i)\n        hash = (((hash << 5) - hash) + c) | 0\n    }\n    return hash\n}\n\nmodule.exports = {\n\tbatch\n\t, vdom\n\t, mixin\n\t, model\n\t, obs\n\t, hamt\n\t, worker\n\t, fp\n}\n","\n// batched requests\n// The `fetch()` module batches in-flight requests, so if at any point in time, anywhere in my front-end or\n// back-end application I have a calls occur to `fetch('http://api.github.com/users/matthiasak')` while another\n// to that URL is \"in-flight\", the Promise returned by both of those calls will be resolved by a single network request.\n\n// f :: (url -> options) -> Promise\nconst batch = f => {\n    let inflight = {}\n\n    return (url, options={}) => {\n        let {method} = options,\n            key = `${url}:${JSON.stringify(options)}`\n\n        if((method || '').toLowerCase() === 'post')\n            return f(url, Object.assign({}, options, {compress: false}))\n\n        return inflight[key] ||\n            (inflight[key] =\n                new Promise((res,rej) => {\n                    f(url, Object.assign({}, options, {compress: false}))\n                    .then(d => res(d))\n                    .catch(e => rej(e))\n                })\n                .then(data => {\n                    inflight = Object.assign({}, inflight, {[key]: undefined})\n                    return data\n                })\n                .catch(e =>\n                    console.error(e, url)))\n    }\n}\n\nexport default batch","const rAF =\n      typeof document !== 'undefined' &&\n      (requestAnimationFrame ||\n      webkitRequestAnimationFrame ||\n      mozRequestAnimationFrame) ||\n      (cb => setTimeout(cb, 16.6))\n\n// Virtual DOMs\nconst vdom = () => {\n    const class_id_regex = () => {\n            return /[#\\.][^#\\.]+/ig\n        },\n        tagName_regex = () => {\n            return /^([^\\.#]+)\\b/i\n        }\n\n    const parseSelector = s => {\n        let test = null,\n            tagreg = tagName_regex().exec(s),\n            tag = tagreg && tagreg.slice(1)[0],\n            reg = class_id_regex(),\n            vdom = Object.create(null)\n\n        if(tag) s = s.substr(tag.length)\n        vdom.className = ''\n        vdom.tag = tag || 'div'\n\n        while((test = reg.exec(s)) !== null){\n            test = test[0]\n            if(test[0] === '.')\n                vdom.className = (vdom.className+' '+test.substr(1)).trim()\n            else if(test[0] === '#')\n                vdom.id = test.substr(1)\n        }\n        return vdom\n    }\n\n    const debounce = (func, wait, immediate, timeout) =>\n        (...args) => {\n            let later = () => {\n                timeout = null\n                !immediate && func(...args)\n            }\n            var callNow = immediate && !timeout\n            clearTimeout(timeout)\n            timeout = setTimeout(later, wait || 0)\n            callNow && func(...args)\n        }\n\n    const hash = (v,_v=JSON.stringify(v)) => {\n        let hash = 0\n        for (let i = 0, len = _v.length; i < len; ++i) {\n            const c = _v.charCodeAt(i)\n            hash = (((hash << 5) - hash) + c) | 0\n        }\n        return hash\n    }\n\n    const m = (selector, attrs=Object.create(null), ...children) => {\n        if(attrs.tag || !(typeof attrs === 'object') || attrs instanceof Array || attrs instanceof Function){\n            if(attrs instanceof Array) children.unshift(...attrs)\n            else children.unshift(attrs)\n            attrs = Object.create(null)\n        }\n        let vdom = parseSelector(selector)\n        if(children.length)\n            vdom.children = children\n        vdom.attrs = attrs\n        vdom.shouldUpdate = attrs.shouldUpdate\n        vdom.unload = attrs.unload\n        vdom.config = attrs.config\n        vdom.__hash = hash(vdom)\n        delete attrs.unload\n        delete attrs.shouldUpdate\n        delete attrs.config\n        return vdom\n    }\n\n    // creatign html, strip events from DOM element... for now just deleting\n    const stripEvents = ({attrs}) => {\n        let a = Object.create(null)\n\n        if(attrs){\n            for(var name in attrs){\n                if(name[0]==='o'&&name[1]==='n') {\n                    a[name] = attrs[name]\n                    delete attrs[name]\n                }\n            }\n        }\n\n        return a\n    }\n\n    const applyEvents = (events, el, strip_existing=true) => {\n        strip_existing && removeEvents(el)\n        for(var name in events){\n            el[name] = events[name]\n        }\n    }\n\n    const flatten = (arr, a=[]) => {\n        for(var i=0,len=arr.length; i<len; i++){\n            let v = arr[i]\n            if(!(v instanceof Array)){\n                a.push(v)\n            } else {\n                flatten(v, a)\n            }\n        }\n        return a\n    }\n\n    const EVENTS = 'mouseover,mouseout,wheel,mousemove,blur,focus,click,abort,afterprint,animationend,animationiteration,animationstart,beforeprint,canplay,canplaythrough,change,contextmenu,dblclick,drag,dragend,dragenter,dragleave,dragover,dragstart,drop,durationchange,emptied,ended,error,load,input,invalid,keydown,keypress,keyup,loadeddata,loadedmetadata,mousedown,mouseenter,mouseleave,mouseup,pause,pointercancel,pointerdown,pointerenter,pointerleave,pointermove,pointerout,pointerover,pointerup,play,playing,ratechange,reset,resize,scroll,seeked,seeking,select,selectstart,selectionchange,show,submit,timeupdate,touchstart,touchend,touchcancel,touchmove,touchenter,touchleave,transitionend,volumechange,waiting'.split(',').map(x => 'on'+x)\n\n    const removeEvents = el => {\n        // strip away event handlers on el, if it exists\n        if(!el) return;\n        for(var i in EVENTS){\n            el[i] = null\n        }\n    }\n\n    let mnt\n\n    const mount = (fn, el) => {\n        mnt = [el, fn]\n        render(fn, el)\n    }\n\n    const render = debounce((fn, el) => rAF(_ => {\n        applyUpdates(fn, el.children[0], el)\n    }))\n\n    const update = () => {\n        if(!mnt) return\n        let [el, fn] = mnt\n        render(fn, el)\n    }\n\n    const stylify = style => {\n        let s = ''\n        for(var i in style){\n            s+=`${i}:${style[i]};`\n        }\n        return s\n    }\n\n    const setAttrs = ({attrs, id, className, __hash},el) => {\n    \tel.className = ''\n    \tel.style = ''\n\n        if(attrs){\n            for(var attr in attrs){\n                if(attr === 'style') {\n                    el.style = stylify(attrs[attr])\n                } else if(attr === 'innerHTML'){\n                    rAF(() => el.innerHTML = attrs[attr])\n                } else if(attr === 'value'){\n                    rAF(() => el.value = attrs[attr])\n                } else {\n                    el.setAttribute(attr, attrs[attr])\n                }\n            }\n        }\n        let _id = attrs.id || id\n        if(_id) el.id = _id\n        let _className = ((attrs.className || '') + ' ' + (className || '')).trim()\n        if(_className) el.className = _className\n        el.__hash = __hash\n    }\n\n    // recycle or create a new el\n    const createTag = (vdom=Object.create(null), el, parent=el&&el.parentElement) => {\n        let __vdom = vdom\n        // make text nodes from primitive types\n        if(typeof vdom !== 'object'){\n            let t = document.createTextNode(vdom)\n            if(el){\n                parent.insertBefore(t,el)\n                removeEl(el)\n            } else {\n                parent.appendChild(t)\n            }\n            return t\n        }\n\n        // else make an HTMLElement from \"tag\" types\n        let {tag, attrs, id, className, unload, shouldUpdate, config, __hash} = vdom,\n            shouldExchange = !el || !el.tagName || (tag && el.tagName.toLowerCase() !== tag.toLowerCase()),\n            _shouldUpdate = !(shouldUpdate instanceof Function) || shouldUpdate(el)\n\n        if(!attrs) return\n        if(el && (!_shouldUpdate || ((!vdom instanceof Function) && el.__hash === __hash))) {\n            return\n        }\n\n        if(shouldExchange){\n            let t = document.createElement(tag)\n            el ? (parent.insertBefore(t, el), removeEl(el)) : parent.appendChild(t)\n            el = t\n        }\n\n        setAttrs(vdom, el)\n        if(el.unload instanceof Function) {\n            rAF(el.unload)\n        }\n        if(unload instanceof Function) {\n            el.unload = unload\n        }\n        applyEvents(stripEvents(vdom), el)\n        config && rAF(_ => config(el))\n        return el\n    }\n\n    // find parent element, and remove the input element\n    const removeEl = el => {\n        if(!el) return\n        el.parentElement.removeChild(el)\n        removeEvents(el)\n        // removed for now, added unload logic to the immediate draw()s\n        if(el.unload instanceof Function)\n            el.unload()\n    }\n\n    const insertAt = (el, parent, i) => {\n        if(parent.children.length > i) {\n            let next_sib = parent.children[i]\n            parent.insertBefore(el, next_sib)\n        } else {\n            parent.appendChild(el)\n        }\n    }\n\n    const applyUpdates = (vdom, el, parent=el&&el.parentElement) => {\n        let v = vdom\n        // if vdom is a function, execute it until it isn't\n        while(vdom instanceof Function)\n            vdom = vdom()\n\n        if(!vdom) return\n\n        if(vdom.resolve instanceof Function){\n            let i = parent.children.length\n            return vdom.resolve().then(v => {\n                if(!el) {\n                    let x = createTag(v, null, parent)\n                    insertAt(x, parent, i)\n                    applyUpdates(v, x, parent)\n                } else {\n                    applyUpdates(v, el, parent)\n                }\n            })\n        }\n\n        // create/edit el under parent\n        let _el = vdom instanceof Array ? parent : createTag(vdom, el, parent)\n\n        if(!_el) return\n\n        if(vdom instanceof Array || vdom.children){\n            let vdom_children = flatten(vdom instanceof Array ? vdom : vdom.children),\n                el_children = vdom instanceof Array ? parent.childNodes : _el.childNodes\n\n            while(el_children.length > vdom_children.length){\n                removeEl(el_children[el_children.length-1])\n            }\n\n            for(let i=0; i<vdom_children.length; i++){\n                applyUpdates(vdom_children[i],el_children[i],_el)\n            }\n        } else {\n            while(_el.childNodes.length > 0){\n                removeEl(_el.childNodes[_el.childNodes.length-1])\n            }\n        }\n    }\n\n    const qs = (s='body', el=document) => el.querySelector(s)\n\n    const resolver  = (states = {}) => {\n        let promises = [],\n            done = false\n\n        const _await = (_promises = []) => {\n            promises = [...promises, ..._promises]\n            return finish()\n        }\n\n        const wait = (ms=0) => new Promise(res => setTimeout(res, ms))\n\n        const isDone = () => done\n\n        const finish = () => {\n            const total = promises.length\n            return wait().then(_ => Promise.all(promises)).then(values => {\n                if(promises.length > total){\n                    return finish()\n                }\n                done = true\n                return states\n            })\n        }\n\n        const resolve = (props) => {\n            const keys = Object.keys(props)\n            if (!keys.length)\n                return Promise.resolve(true)\n\n            let f = []\n            keys.forEach(name => {\n                let x = props[name]\n\n                while(x instanceof Function)\n                    x = x()\n\n                if(x && x.then instanceof Function)\n                    f.push(x.then(d => states[name] = d))\n            })\n\n            return _await(f)\n        }\n\n        const getState = () => states\n\n        return { finish, resolve, getState, promises, isDone }\n    }\n\n    const gs = (view, state) => {\n        let r = view(state)\n        while(r instanceof Function)\n            r = view(instance.getState())\n        return r\n    }\n\n    const container = (view, queries={}, instance=resolver()) => {\n        let wrapper_view = state =>\n            instance.isDone() ? view(state) : m('span')\n\n        return () => {\n            let r = gs(wrapper_view, instance.getState())\n            instance.resolve(queries)\n\n            if(r instanceof Array) {\n                let d = instance.finish().then(_ =>\n                    gs(wrapper_view, instance.getState()))\n\n                return r.map((x,i) => {\n                    x.resolve = _ => d.then(vdom => vdom[i])\n                    return x\n                })\n            }\n\n            r.resolve = _ => instance.finish().then(_ =>\n                gs(wrapper_view, instance.getState()))\n\n            return r\n        }\n    }\n\n    const reservedAttrs = ['className','id']\n\n    const toHTML = _vdom => {\n        while(_vdom instanceof Function) _vdom = _vdom()\n        if(_vdom instanceof Array) return new Promise(r => r(html(..._vdom)))\n        if(!_vdom) return new Promise(r => r(''))\n        if(typeof _vdom !== 'object') return new Promise(r => r(_vdom))\n        return (_vdom.resolve ? _vdom.resolve() : Promise.resolve()).then(vdom => {\n            if(!vdom) vdom = _vdom\n\n            if(vdom instanceof Array) return new Promise(r => r(html(...vdom)))\n\n            const {tag, id, className, attrs, children, instance} = vdom,\n                _id = (id || (attrs && attrs.id)) ? ` id=\"${(id || (attrs && attrs.id) || '')}\"` : '',\n                _class = (className || (attrs && attrs.className)) ? ` class=\"${((className||'') + ' ' + (attrs.className||'')).trim()}\"` : ''\n\n            const events = stripEvents(vdom)\n            let _attrs = '',\n                inner = ''\n            for(var i in (attrs || Object.create(null))){\n                if(i === 'style'){\n                    _attrs += ` style=\"${stylify(attrs[i])}\"`\n                } else if(i === 'innerHTML') {\n                    inner = attrs[i]\n                } else if(reservedAttrs.indexOf(i) === -1){\n                    _attrs += ` ${i}=\"${attrs[i]}\"`\n                }\n            }\n\n            if(!inner && children)\n                return html(...children).then(str =>\n                    `<${tag}${_id}${_class}${_attrs}>${str}</${tag}>`)\n\n            if('br,input,img'.split(',').filter(x => x===tag).length === 0)\n                return new Promise(r => r(`<${tag}${_id}${_class}${_attrs}>${inner}</${tag}>`))\n\n            return new Promise(r => r(`<${tag}${_id}${_class}${_attrs} />`))\n        })\n    }\n\n    const html = (...v) => Promise.all(v.map(toHTML)).then(x => x.filter(x => !!x).join(''))\n\n    return {container, html, qs, update, mount, m, debounce}\n}\n\nmodule.exports = vdom()\n\n/*\nusage:\n\nlet component = () =>\n    new Array(20).fill(true).map(x =>\n        m('div', {onMouseOver: e => log(e.target.innerHTML)}, range(1,100)))\n\nclient-side\n-----\nmount(component, qs())\n\nclient-side constant re-rendering\n-----\nconst run = () => {\n    setTimeout(run, 20)\n    update()\n}\nrun()\n*/\n\n/* CONTAINER / HTML USAGE (Server-side rendering)\n\nconst name = _ => new Promise(res => setTimeout(_ => res('matt'), 1500))\n\nlet x = container(data => [\n        m('div.test.row', {className:'hola', 'data-name':data.name, style:{border:'1px solid black'}}),\n        m('div', data.name),\n    ],\n    {name}\n)\n\nhtml(x).then(x => log(x)).catch(e => log(e+''))\n*/\n","\nconst mixin = (...classes) => {\n    class _mixin {}\n\n    let proto = _mixin.prototype\n\n    classes.map(({prototype:p}) => {\n        Object.getOwnPropertyNames(p).map(key => {\n            let oldFn = proto[key] || ($ => {})\n            proto[key] = function() {\n                oldFn.apply(null, [].slice.call(arguments))\n                return p[key].apply(null, [].slice.call(arguments))\n            }\n        })\n    })\n\n    return _mixin\n}\n\nmodule.exports = mixin","// Validate JS objects for their \"shape\"\nconst model = {\n    is(type, value) {\n        if(type && type.isValid instanceof Function){\n            return type.isValid(value)\n        } else if((type === String && ((value instanceof String) || typeof value === 'string'))\n            || (type === Number && ((value instanceof Number) || typeof value === 'number'))\n            || (type === Boolean && ((value instanceof Boolean) || typeof value === 'boolean'))\n            || (type === Function && ((value instanceof Function) || typeof value === 'function'))\n            || (type === Object && ((value instanceof Object) || typeof value === 'object'))\n            || (type === undefined)\n        ){\n            return true\n        }\n\n        return false\n    },\n    check(types, required, data) {\n        Object.keys(types).forEach(key => {\n            let t = types[key],\n                value = data[key]\n\n            if(required[key] || value !== undefined){\n                if(!(t instanceof Array)) t = [t]\n\n                let i = t.reduce((a,_type) => a || MODEL.is(_type, value), false)\n                if(!i) {\n                    throw `{${key}: ${JSON.stringify(value)}} is not one of ${t.map(x => `\\n - ${x}`)}`\n                }\n            }\n        })\n\n        return true\n    },\n    init(...args) {\n        let types, required, logic\n        args.map(x => {\n            if(x instanceof Function && !logic){ logic = x }\n            else if(typeof x === 'object') {\n                if(!types){ types = x }\n                else if(!required){ required = x }\n            }\n        })\n\n        const isValid = (data) => {\n            const pipe = logic ? [check, logic] : [check]\n            return pipe.reduce((a,v) => a && v(types||{},required||{},data), true)\n        }\n\n        const whenValid = (data) => new Promise((res,rej) => isValid(data) && res(data))\n\n        return {isValid, whenValid}\n    },\n    ArrayOf(M) {\n        return MODEL.init((t,r,data) => {\n            if(!(data instanceof Array)) throw `${data} not an Array`\n            data.map(x => {\n                if(!MODEL.is(M, x))\n                    throw `${x} is not a model instance`\n            })\n            return true\n        })\n    }\n}\n\nexport default model\n\n/**\nUse it\n\n// create a Name model with required first/last,\n// but optional middle\nlet Name = MODEL.init({\n    first: String,\n    middle: String,\n    last: String\n}, {first:true, last:true})\n\n// create a Tags model with extra checks\nlet Tags = MODEL.init((types,required,data) => {\n    if(!(data instanceof Array)) throw `${data} not an Array`\n    data.map(x => {\n        if(!is(String, x))\n            throw `[${data}] contains non-String`\n    })\n    return true\n})\n\n// create a Price model that just has a business logic fn\nlet Price = MODEL.init((t,r,d) => {\n    return (d instanceof Number || typeof d === 'number') && d !== 0\n})\n\n// create an Activity model with a required type and name,\n// all others optional\nlet Activity = MODEL.init({\n    type: [String, Function, Number],\n    latlng: Array,\n    title: String,\n    tags: Tags,\n    name: Name,\n    price: Price\n}, {name:true, price: true})\n\n// create a new Activity instance, throwing errors if there are\n// any invalid fields.\nlet a = {\n    tags: ['1','2'],\n    type: 1,\n    name: {first:'matt',last:'keas'},\n    price: 100.43,\n    url: 'http://www.google.com'\n}\nActivity.whenValid(a).then(log).catch(e => log(e+''))\n**/\n","// async-supporting-observables\nconst obs = (state) => {\n    let subscribers = []\n\n    const fn = (val) => {\n        if(val !== undefined){\n            state = val\n            for(let i = 0, len = subscribers.length; i<len; i++)\n            \tsubscribers[i](val)\n        }\n        return state\n    }\n\n    fn.map = f => {\n      const o = obs()\n      subscribers.push(val => o(f(val)))\n      return o\n    }\n\n    fn.filter = f => {\n      const o = obs()\n      subscribers.push(val => f(val) && o(val))\n      return o\n    }\n\n    fn.then = f => {\n      subscribers.push(val => f(val))\n      return fn\n    }\n\n    fn.take = (n) => {\n        const values = [],\n        \to = obs()\n\n        const cb = val => {\n            if(values.length < n)\n                values.push(val)\n\n            if(values.length === n) {\n                subscribers.delete(cb)\n                return o(values)\n            }\n        }\n\n        subscribers.push(cb)\n\n        return o\n    }\n\n    fn.takeWhile = f => {\n        const values = [],\n        \to = obs()\n\n        const cb = val => {\n            if(!f(val)) {\n                subscribers = subscribers.filter(x => x !== cb)\n                return o(values)\n            }\n\n\t\t\tvalues.push(val)\n        }\n\n        subscribers.push(cb)\n\n        return o\n    }\n\n    fn.reduce = (f,acc) => {\n        const o = obs()\n\n        subscribers.push(val => {\n            acc = f(acc,val)\n            o(acc)\n        })\n\n        return o\n    }\n\n    fn.maybe = f => {\n        const success = obs(),\n              error = obs(),\n              cb = val =>\n        \t\tf(val)\n\t\t\t\t    .then(d => success(d))\n                    .catch(e => error(e))\n\n        subscribers.push(cb)\n\n        return [ success, error ]\n    }\n\n    fn.stop = () => subscribers = []\n\n    fn.debounce = ms => {\n        const o = obs()\n        let ts = +new Date\n        subscribers.push(val => {\n            const now = +new Date\n            if(now - ts >= ms){\n                ts = +new Date\n                o(val)\n            }\n        })\n        return o\n    }\n\n    return fn\n}\n\nobs.from = f => {\n    const o = obs()\n    f(x => o(x))\n    return o\n}\n\nobs.union = (...fs) => {\n    const o = obs()\n    fs.map(f => f.then(o))\n    return o\n}\n\nexport default obs","// compute the hamming weight\nexport const hamming = x => {\n    x -= ((x >> 1) & 0x55555555)\n    x = (x & 0x33333333) + ((x >> 2) & 0x33333333)\n    x = (x + (x >> 4)) & 0x0f0f0f0f\n    x += (x >> 8)\n    x += (x >> 16)\n    return (x & 0x7f)\n}\n\nexport const popcount = root => {\n    if(root.key)\n        return 1\n\n    let c = root.children\n    if(c) {\n        var sum = 0\n        for(var i in c) sum += popcount(c[i])\n        return sum\n    }\n}\n\n// hash fn\nexport const hash = (v='') => {\n    v = JSON.stringify(v)\n    var hash = 5381\n    for (let i = 0; i < v.length; i++)\n        hash = ((hash << 5) + hash) + v.charCodeAt(i)\n    return hash\n}\n\n// compare two hashes\nexport const comp = (a,b) => hash(a) === hash(b)\n\n// get a bit vector\nexport const HMAP_SIZE = 8\nexport const MAX_DEPTH = 32 / HMAP_SIZE - 1\nexport const vec = (h=0, i=0, range=HMAP_SIZE) => (h >>> (range*i)) & ((1 << range) - 1)\n\nexport const shallowClone = x => {\n    let y = Object.create(null)\n    for(let i in x)\n        y[i] = x[i]\n    return y\n}\n\nexport const cloneNode = x => {\n    let y = node()\n    if(!x) return y\n\n    if(x.children) {\n        y.children = shallowClone(x.children)\n    } else if(x.key !== undefined) {\n        y.key = x.key\n        y.val = x.val\n        y.hash = x.hash\n    }\n\n    return y\n}\n\nexport const numChildren = x => {\n    let c = 0\n    for(var i in x) ++c\n    return c\n}\n\nexport const set = (root, key, val) => {\n    if((root.key === undefined) && !root.children) return node(key, val)\n\n    const newroot = cloneNode(root), h = hash(key)\n\n    // walk the tree\n    for(var i = 3, r = root, n = newroot; i >= 0; --i){\n        let bits = vec(h, i)\n\n        if(r.key !== undefined){\n            // if we have a collision\n            if(r.key === key || i === 0) {\n                // if keys match or is leaf, just overwrite n's val\n                n.val = val\n            } else if(i !== 0) {\n                // else if r is not at max depth and keys don't match\n                // add levels to both trees, new tree must be able\n                // to access old data\n\n                // 0. create makeshift value node for r\n                // and new value node for n\n                let cp = node(r.key, r.val, r.hash)\n                let cn = node(key, val, h)\n                let rh = r.hash\n\n                // 1. delete value props from nodes\n                delete r.key\n                delete r.val\n                delete r.hash\n                delete n.key\n                delete n.val\n                delete n.hash\n\n                // 2. create layers until bit-vectors don't collide\n                for(let j = i, __r = r, __n = n; j >= 0; j--){\n                    let vecr = vec(rh, j),\n                        vecn = vec(h, j)\n\n                    // create new layer for c and r\n                    let c = __r.children = Object.create(null)\n                    let d = __n.children = shallowClone(c)\n\n                    if(vecr !== vecn) {\n                        c[vecr] = cp\n                        d[vecr] = cp\n                        d[vecn] = cn\n                        break\n                    } else {\n                        __r = c[vecr] = node()\n                        __n = d[vecn] = cloneNode(__r)\n                    }\n                }\n            }\n            break\n        } else if(r.children) {\n            let _r = r.children[bits]\n            if(!_r) {\n                n = n.children[bits] = node(key, val)\n                break\n            } else {\n                r = _r\n                n = n.children[bits] = cloneNode(r)\n            }\n        }\n    }\n\n    return newroot\n}\n\nexport const get = (root, key) => {\n    if(root.key === key) return root.val\n    const h = hash(key)\n    for(let i = 3, r = root; i >= 0; --i){\n        if(!r.children) return undefined\n        r = r.children[vec(h, i)]\n        if(!r) return undefined\n        if(r.key !== undefined) return r.val\n    }\n\n    return undefined\n}\n\nexport const first = root => {\n    let c = root.children\n    for(let i in c) return c[i]\n}\n\nexport const unset = (root, key) => {\n    const n = cloneNode(root),\n          h = hash(key)\n\n    for(var i = 3, _n = n, p = n; i >= -1; --i) {\n        if(_n.key) {\n            delete _n.key\n            delete _n.val\n            delete _n.hash\n            return n\n\n//             let c = numChildren(p)\n\n//             if(c === 1) {\n//                 // if only child, delete child and parent?\n//                 delete p.children\n//             } else if(c===2){\n//                 // if 2 children, promote sibling as parent value nod\n//                 delete p.children[bits]\n//                 let sibling = first(p)\n//                 delete p.children\n//                 if(sibling.children){\n//                     p.children = sibling.children\n//                 } else if(p.key) {\n//                     p.val = sibling.val\n//                     p.hash = sibling.hash\n//                     p.key = sibling.key\n//                 }\n//             } else {\n//                 // if more than 2 children, just delete the one\n//                 delete p.children[bits]\n//             }\n//             return n\n        }\n\n        const bits = vec(h, i)\n        _n = _n && _n.children && _n.children[bits]\n        if(!_n) return n\n        p = _n\n    }\n    return n\n}\n\nexport const node = (key,val,h= key !== undefined && hash(key)) => {\n    /*\n    potential props of a tree node\n    - key - hashkey\n    - val - value\n    - children - { ... } -> points to other nodes (List<Node> children)\n    */\n\n    let item = Object.create(null)\n    if(key !== undefined){\n        item.key = key\n        item.hash = h\n        item.val = val\n    }\n    return item\n}\n\nexport const map = (root, fn) => {\n    if(root.key !== undefined)\n        return node(root.key, fn(root.val, root.key), root.hash)\n\n    let d = cloneNode(root),\n        c = d.children\n\n    if(c) {\n        for(var i in c){\n            c[i] = map(c[i], fn)\n        }\n    }\n\n    return d\n}\n\nexport const filter = (root, fn) => {\n    if(root.key !== undefined)\n        return fn(root.val, root.key) ? root : undefined\n\n    let d = cloneNode(root),\n        c = d.children\n\n    if(c) {\n        for(var i in c){\n            if(!filter(c[i], fn))\n                delete c[i]\n        }\n    }\n\n    return d\n}\n\nexport const reduce = (root, fn, acc) => {\n    if(root.key !== undefined)\n        return fn(acc, root.val, root.key)\n\n    let c = root.children\n    if(c) {\n        for(var i in c)\n            acc = reduce(c[i], fn, acc)\n\n        return acc\n    }\n}\n\nexport const toList = (root, r=[]) => {\n    if(root.key !== undefined) r.push(root.val)\n\n    let c = root.children\n    if(c) {\n        for(var i in c) {\n            toList(c[i], r)\n        }\n    }\n\n    return r\n}\n\nexport const toOrderedList = (root, r=[]) => {\n    let i = 0,\n        n\n\n    do {\n        n = get(root, i++)\n        n !== undefined && r.push(n)\n    } while(n)\n\n    return r\n}\n\nexport const toJSON = (root, r={}) => {\n    if(root.key !== undefined)\n        r[root.key] = root.val\n\n    let c = root.children\n    if(c) {\n        for(var i in c) {\n            toJson(c[i], r)\n        }\n    }\n\n    return r\n}\n\nexport const push = (root, val) => set(root, popcount(root), val)\n\nexport const pop = root => unset(root, popcount(root)-1)\n\nexport const shift = root => reduce(\n    unset(root, 0),\n    (acc,v,k) => set(acc, k-1, v),\n    node())\n\nexport const unshift = (root, val) =>\n    set(\n        reduce(\n            root,\n            (acc,v,k) => set(acc, k+1, v),\n            node()),\n        0,\n        val)\n\nexport const hamt = node\n\n// console.clear()\n// const l = (...args) => console.log(...args)\n// const j = (...a) => console.log(JSON.stringify(a))\n\n// let x = hamt()\n// let s = 20\n\n// Array(s).fill(1).map((v,i) => {\n//     x = set(x, i, i)\n// })\n\n// l(toList(x))\n// l(toJson(x))\n\n// x = map(x, x => log(x*x) || x*x)\n// l(get(x, 19))\n\n// l(x)\n// l(reduce(x, (acc, x) => acc+x, 0))\n\n// x = unset(x, 1)\n// Array(s).fill(1).map((_,i) => {\n//     if(!get(x, i)) l(i)\n//     // l(get(x, i))\n// })","const supports = (...q) => () =>\n    q.reduce((acc,s) =>\n        acc\n        || (window[s] !== undefined)\n        && /[native code]/.test(window[s]+'')\n        && window[s]\n    , false)\n\nconst supportsWorkers = supports('Worker')\n\nconst supportsBlobs = supports('Blob')\n\nconst supportsURLs = supports('URL', 'webkitURL')\n\nconst supportsBuilders = supports('BlobBuilder', 'WebKitBlobBuilder', 'MozBlobBuilder')\n\n/*\nworker:: [X] -> Worker where X : Function | String\n\nthe last X provided in the arguments will be setup as the handler for self.onmessage()\n*/\nexport const worker = (...code) => {\n    if(!supportsWorkers()) throw 'WebWorkers not supported'\n\n    code[code.length-1] = `self.onmessage=${code[code.length-1]}`\n\n    const B = supportsBlobs()\n        , U = supportsBuilders()\n        , W = supportsURLs()\n\n    let blob\n\n    if(supportsBlobs()) {\n        blob =\n            new B(code.map(c => c+''),\n            {type: 'application/javascript'})\n\n    } else if(U){\n        blob = new U\n        code.map(c => blob.append(c+''))\n        blob = blob.getBlob()\n    } else {\n        blob = `data:application/javascript,`\n            +`${encodeURIComponent(\n                code.reduce((acc,c) => acc+c, '')\n              )}`\n    }\n\n    let url = W.createObjectURL(blob)\n    return new Worker(url)\n}\n\nexport const farm = (n, ...code) => {\n    let workers = Array(n).fill(1).map(x => worker(...code))\n        , current = 0\n        , iter = () => {\n            let _n = current\n            ++current >= n && (current = 0)\n            return current\n        }\n        , pipe\n        , onerror\n\n    workers.map(w => {\n        w.onmessage = e => pipe instanceof Function && pipe(e.data)\n        w.onerror = e => onerror instanceof Function && onerror(e)\n    })\n\n    const exec = (...args) => {\n        let w = workers[iter()]\n        w && w.postMessage(args)\n    }\n\n    exec.pipe = fn => {\n        pipe = fn\n        return exec\n    }\n    exec.error = fn => {\n        onerror = fn\n        return exec\n    }\n    return exec\n}\n","export const log = (...a) => console.log(...a)\n\n// rAF\nexport const rAF =\n      typeof document !== 'undefined' &&\n      (requestAnimationFrame ||\n      webkitRequestAnimationFrame ||\n      mozRequestAnimationFrame) ||\n      process && process.nextTick ||\n      (cb => setTimeout(cb, 16.6))\n\n// composition\n// c :: (T -> U) -> (U -> V) -> (T -> V)\nexport const c = (f,g) => x => f(g(x))\n\n// cof :: [(an -> bn)] -> a0 -> bn\n// compose forward\nexport const cof = (...fns) => fns.reduce((acc,fn) => c(acc, fn))\n\n// cob :: [(an -> bn)] -> b0 -> an\n// compose backwards\nexport const cob = (...fns) => cof(...fns.reverse())\n\n// functional utilities\n// pointfree\nexport const pf = fn => (...args) => x => fn.apply(x, args)\n\n// curry\n// curry :: (T -> U) -> [args] -> ( -> U)\nexport const curry = (fn, ...args) =>\n\tfn.bind(undefined, ...args)\n\n\n// Transducers\nexport const mapping = (mapper) => // mapper: x -> y\n    (reducer) => // reducer: (state, value) -> new state\n        (result, value) =>\n            reducer(result, mapper(value))\n\nexport const filtering = (predicate) => // predicate: x -> true/false\n    (reducer) => // reducer: (state, value) -> new state\n        (result, value) =>\n            predicate(value) ? reducer(result, value) : result\n\nexport const concatter = (thing, value) =>\n    thing.concat([value])\n"]}